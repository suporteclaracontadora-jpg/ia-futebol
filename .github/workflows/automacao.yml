name: Automa√ß√£o da IA de Futebol

# AGENDAMENTO: Roda a previs√£o todos os dias √†s 04:00 UTC (01:00 AM BRT)
# e roda a atualiza√ß√£o de dados no dia 1 de cada m√™s (01:00 AM BRT)
on:
  schedule:
    # Previs√£o Di√°ria: 01:00 AM Hor√°rio de Bras√≠lia (BRT)
    - cron: '0 4 * * *'
    # Atualiza√ß√£o Mensal: Dia 1 de cada m√™s, 01:00 AM BRT
    - cron: '0 4 1 * *'
  # Permite rodar manualmente clicando no bot√£o "Run workflow" no GitHub
  workflow_dispatch:

jobs:
  # JOB 1: Previs√£o Di√°ria (Coleta jogos agendados e faz a previs√£o)
  previsao_diaria:
    # Roda apenas na cron di√°ria ou manualmente
    if: github.event_name == 'workflow_dispatch' || github.event.schedule == '0 4 * * *'
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout do C√≥digo
      uses: actions/checkout@v4

    # CORRE√á√ÉO: Mudar vers√£o do Python para 3.11
    - name: Configurar Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'

    # Instala as 3 bibliotecas diretamente (corrigindo erro de depend√™ncia)
    - name: Instalar Depend√™ncias (Direto)
      run: |
        pip install --upgrade pip
        pip install requests pandas joblib
    
    - name: üß† Rodar o ia.py (Coletar jogos futuros e prever)
      run: python ia.py

    - name: üíæ Salvar Previs√µes no GitHub Gist
      # ESTE PASSO CRIA UM ARQUIVO DE TEXTO NA NUVEM (GIST) COM AS SUAS PREVIS√ïES!
      uses: softprops/action-gh-gist@v1
      with:
        files: previsoes_do_dia.csv
        token: ${{ secrets.GIST_TOKEN }}
        gist_id: '' 
        update: true

  # JOB 2: Atualiza√ß√£o Mensal (Coleta Resultados Antigos para Manuten√ß√£o do Modelo)
  atualizacao_mensal:
    # Roda apenas na cron mensal (dia 1)
    if: github.event.schedule == '0 4 1 * *'
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout do C√≥digo
      uses: actions/checkout@v4

    - name: Configurar Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'

    - name: Instalar Depend√™ncias
      run: pip install requests pandas joblib
    
    # ‚ö†Ô∏è A√á√ÉO FUTURA: Coleta de jogos passados e re-treino
    - name: üîÑ Rodar Coleta de Resultados Antigos (Opcional)
      run: |
        echo "Lembrete: Para manter a IA aprendendo, crie um script (ex: retreino.py) que colete os resultados dos jogos que j√° passaram e re-treine seu modelo .pkl."
        echo "Comando a ser adicionado aqui: python retreino.py"
